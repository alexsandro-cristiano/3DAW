<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Listar Produto</title>
</head>
<body>
    <header>
        <h1>Loja Ximbolé Bahiano</h1>
        <nav>
            <span style="padding-right: 10px"><a href="listar.html">Listar Todos Produtos</a></span>
            <span style="padding-right: 10px"><a href="listar.html">Listar Um Produto</a></span>
            <span style="padding-right: 10px"><a href="index.html">Incluir Produtos</a></span>
            <span style="padding-right: 10px"><a href="alterar.html">Alterar Produtos</a></span>
            <span style="padding-right: 10px"><a href="excluir.html">Excluir Produtos</a></span>
        </nav>
    </header>

    <h3>Procurar Produto</h3>
<form action="" id="procurar">
  Código de Barras: <input type="text" id="codBar">
  <br><br>
  <input type="button" value="Pesquisar Produto" onclick="validarForm()">
  <br><br>
  <p id="msgErro"></p>
</form>

<script>
  function EnviarForm() {
     let xmlHttp = new XMLHttpRequest();
     let codBar = document.getElementById("codBar").value;

     xmlHttp.onreadystatechange = function() {
       if (this.readyState == 4 && this.status == 200) {
         console.log("Retornou: " + this.responseText);
         document.getElementById("msgErro").value = this.responseText;
       }
     }
     xmlHttp.open("GET", "./backend/php/listarum.php?codBar=" + codBar, true);
     xmlHttp.send();
     console.log("Requisição enviada.")
 }

 function validarForm() {
 let msgErro = "";
 let codBar = document.getElementById("codBar").value;

 if (!ValidarcodBar(codBar)) {
     msgErro = "codigo de barra nao pode ser vazio \n";
 }

 if(msgErro != "") {
     document.getElementById("msgErro").innerText = msgErro;
 }
 else {
     EnviarForm();
 }

}


function ValidarcodBar(codBar) {
 if (codBar == "") {
   return false;
 }
 return true;
}

</script>
</body>

</html>